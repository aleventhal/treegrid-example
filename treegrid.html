<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="./treegrid.css">
  <script src="./treegrid.js"></script>
</head>
<body>
<form>
  <fieldset>
    <legend>Behavior settings</legend>
    <div>
    <input id="autoFocusRowOnCol0" type="checkbox" checked>
    <label for="autoFocusRowOnCol0">Automatically focus row after navigating to first column</label>
    <div>
    <input id="keepColAfterRowNav" type="checkbox" checked>
    <label for="keepColAfterRowNav">If switching rows, and a column was focused, stay in the same column (rather than focusing entire new row)</label>
  </fieldset>
</form>

<hr>

<table id="treegrid" role="treegrid" summary="ARIA treegrid example">
  <colgroup>
    <col width="20%"></col>
    <col width="40%"></col>
    <col width="*"></col>
  </colgroup>
  <thead>
    <th>Subject</th>
    <th>Summary</th>
    <th>Email</th>
  </thead>
  <tbody>
    <tr id="1" role="row" aria-level="1" aria-posinset="1" aria-setsize="1" aria-expanded="true">
      <td role="gridcell">Treegrids are broken</td>
      <td role="gridcell">How do we fix them?</td>
      <td role="gridcell">aaron@thegoogle.rocks</td>
    </tr>
    <tr id="1.1" role="row" aria-level="2" aria-posinset="1" aria-setsize="3">
       <td role="gridcell">re: Treegrids are broken</td>
       <td role="gridcell">I agree with you, but ...</td>
       <td role="gridcell">joe@blahblahblah.blahblah</td>
    </tr>
    <tr id="1.2" role="row" aria-level="2" aria-posinset="2" aria-setsize="3" aria-expanded="true">
       <td role="gridcell">re: Treegrids are broken
       <td role="gridcell">Not that many people use them
       <td role="gridcell">billy@dangerous.fish</td>
    </tr>
    <tr id="1.2.1" role="row" aria-level="3" aria-posinset="1" aria-setsize="1">
       <td role="gridcell">re: Treegrids are broken</td>
       <td role="gridcell">We still need them, plus it's a spec hole</td>
       <td role="gridcell">doris@rufflazydogs.sleep</td>
    </tr>
    <tr id="1.3" role="row" aria-level="2" aria-posinset="3" aria-setsize="3" aria-expanded="true">
       <td role="gridcell">re: Treegrids are broken</td>
       <td role="gridcell">Can someone suggest something?</td>
       <td role="gridcell">someone@pleasedoit.company</td>
    </tr>
    <tr id="1.3.1" role="row" aria-level="3" aria-posinset="1" aria-setsize="1" aria-expanded="false">
       <td role="gridcell">re: Treegrids are broken</td>
       <td role="gridcell">They are more like trees than grids, not that many columns usually</td>
       <td role="gridcell">mari@beingpractical.com</td>
    </tr>
    <tr id="1.3.1.1" role="row" aria-level="4" aria-posinset="1" aria-setsize="2" aria-hidden="true">
       <td role="gridcell">re: Treegrids are broken</td>
       <td role="gridcell">Cool, let's keep left/right collapse/expand like a tree</td>
       <td role="gridcell">issie@imadeadcatsadly.wascute</td>
    </tr>
    <tr id="1.3.1.2" role="row" aria-level="4" aria-posinset="2" aria-setsize="2" aria-hidden="true">
       <td role="gridcell">re: Treegrids are broken
       <td role="gridcell">There be a column navigation command</td>
       <td role="gridcell">kitten@kittenseason.future</td>
    </tr>
  </tbody>
</table>

<hr>
<h1>Explanation of UI</h1>
<ul>
<li>Up/down - moves by row is in an ordinary tree
<li>Left/right - collapses/expands or moves to parent/first-child as in an ordinary tree
<li>Move by word key (ctrl+left/right or alt/left+right depending on the platform) - move by column
<li>Home/end - move to first/last row or column, depending on whether the last thing focused was a row or column
</ul>
<h1>Explanation of markup</h1>
<ul>
<li>roles used are treegrid, row and gridcell
<li>aria-level: used to set the current level of an item, 1, 2, 3, etc.
<li>aria-posinset, aria-setsize: used to indicate the position of an item within it's local group, such as item 3 of 5
<li>aria-expanded (triststate): this attribute must be removed (not present) if the item cannot be expanded. For expandable items, the value is "true" or "false"
<li>aria-hidden: set to "true" for child items that are currently hidden because the parent is collapsed
<li>aria-owns: not currently used, awaiting discussion. Could be used for parents to identify their children.
<li>aria-labelledby or aria-describedby for headers? Not currently used, awaiting discussion
<li>aria-activedescendant -- this example does not use, because it is not exposed to ATs in IE, and thus uses tabindex instead
<li>tabindex is set in the JS, as per the usual roving tabindex methodology. Specifically, we use tabindex="0" for the current item so that it is the subitem that gets focused if user tabs out and back in, and tabindex="-1" for all items where we want click-to-focus behavior enabled.
</ul>
</body>
</html>
